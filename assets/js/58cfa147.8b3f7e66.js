"use strict";(globalThis.webpackChunkmy_website=globalThis.webpackChunkmy_website||[]).push([[430],{8453:(e,n,s)=>{s.d(n,{R:()=>c,x:()=>a});var t=s(6540);const i={},r=t.createContext(i);function c(e){const n=t.useContext(r);return t.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:c(e.components),t.createElement(r.Provider,{value:n},e.children)}},8830:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>o,contentTitle:()=>a,default:()=>h,frontMatter:()=>c,metadata:()=>t,toc:()=>l});const t=JSON.parse('{"id":"k8s-core-myths/pod-and-container-myths/Kubernetes_Pods_Always_Need_a_Service_Account","title":"Myth: Kubernetes Pods Always Need a Service Account","description":"I\u2019ve seen engineers argue that disabling Service Account tokens is unsafe because \u201cpods need it to run.\u201d","source":"@site/docs/k8s-core-myths/pod-and-container-myths/Kubernetes_Pods_Always_Need_a_Service_Account.md","sourceDirName":"k8s-core-myths/pod-and-container-myths","slug":"/k8s-core-myths/pod-and-container-myths/Kubernetes_Pods_Always_Need_a_Service_Account","permalink":"/k8s-core-myths/pod-and-container-myths/Kubernetes_Pods_Always_Need_a_Service_Account","draft":false,"unlisted":false,"editUrl":"https://github.com/kubernetes-myths/website/blob/main/docs/k8s-core-myths/pod-and-container-myths/Kubernetes_Pods_Always_Need_a_Service_Account.md","tags":[],"version":"current","sidebarPosition":5,"frontMatter":{"sidebar_position":5},"sidebar":"k8sCoreMythsSidebar","previous":{"title":"Myth: Init Containers can run in any order or in parallel","permalink":"/k8s-core-myths/pod-and-container-myths/Init_Containers_can_run_in_any_order_or_in_parallel"},"next":{"title":"Security Myths","permalink":"/category/security-myths"}}');var i=s(4848),r=s(8453);const c={sidebar_position:5},a="Myth: Kubernetes Pods Always Need a Service Account",o={},l=[{value:"Why This Myth Exists?",id:"why-this-myth-exists",level:3},{value:"The Reality:",id:"the-reality",level:3},{value:"Experiment &amp; Validate",id:"experiment--validate",level:3},{value:"Key Takeaways",id:"key-takeaways",level:3}];function d(e){const n={code:"code",h1:"h1",h3:"h3",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,r.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"myth-kubernetes-pods-always-need-a-service-account",children:"Myth: Kubernetes Pods Always Need a Service Account"})}),"\n",(0,i.jsx)(n.p,{children:"I\u2019ve seen engineers argue that disabling Service Account tokens is unsafe because \u201cpods need it to run.\u201d"}),"\n",(0,i.jsx)(n.p,{children:"This confusion usually surfaces when teams start hardening clusters and notice that every pod automatically has a Service Account attached, even simple workloads like NGINX or batch jobs that never talk to the Kubernetes API."}),"\n",(0,i.jsx)(n.p,{children:"The question then becomes:"}),"\n",(0,i.jsx)(n.p,{children:"If the pod doesn\u2019t need API access, why does Kubernetes still attach a Service Account?"}),"\n",(0,i.jsx)(n.h3,{id:"why-this-myth-exists",children:"Why This Myth Exists?"}),"\n",(0,i.jsx)(n.p,{children:"This myth exists because of Kubernetes\u2019 secure-by-default behavior:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"Kubernetes automatically assigns a Service Account (default) to every pod."}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"A token for that Service Account is mounted into the pod by default."}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"From the outside, it looks like the Service Account is required for pod execution."}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"In reality, the pod is not using the Service Account unless it explicitly talks to the Kubernetes API."}),"\n",(0,i.jsx)(n.h3,{id:"the-reality",children:"The Reality:"}),"\n",(0,i.jsx)(n.p,{children:"A Service Account is only required when a pod needs an identity to authenticate with the Kubernetes API server."}),"\n",(0,i.jsx)(n.p,{children:"Examples include:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"Controllers managing Kubernetes resources"}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"Jobs fetching Secrets dynamically via the API"}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"Operators watching or modifying cluster objects"}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"For workloads that do not interact with the API:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"The Service Account is never used"}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"The token is unnecessary"}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"Leaving it mounted increases the attack surface"}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"Kubernetes assigns a Service Account to every pod to ensure:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"Consistent identity handling"}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"RBAC enforcement"}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"Secure defaults for workloads that might need API access"}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"experiment--validate",children:"Experiment & Validate"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Step 1: Create a Pod With Default Behavior"})}),"\n",(0,i.jsx)(n.p,{children:"This pod does not talk to the Kubernetes API."}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-yaml",children:'apiVersion: v1\r\nkind: Pod\r\nmetadata:\r\n  name: default-sa-pod\r\nspec:\r\n  containers:\r\n  - name: app\r\n    image: busybox\r\n    command: ["sh", "-c", "sleep 3600"]\n'})}),"\n",(0,i.jsx)(n.p,{children:"Apply it:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-sh",children:"kubectl apply -f pod-default.yaml\n"})}),"\n",(0,i.jsx)(n.p,{children:"Now inspect the Service Account token:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-sh",children:"kubectl exec -it default-sa-pod -- ls /var/run/secrets/kubernetes.io/serviceaccount/\n"})}),"\n",(0,i.jsx)(n.p,{children:"Expected Output:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-cpp",children:"ca.crt\r\nnamespace\r\ntoken\n"})}),"\n",(0,i.jsx)(n.p,{children:"Kubernetes mounted a token even though the pod does nothing with it."}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Step 2: Prove the Pod Does NOT Use the Token"})}),"\n",(0,i.jsx)(n.p,{children:"Run any normal Linux command:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-sh",children:'kubectl exec -it default-sa-pod -- echo "App is running"\n'})}),"\n",(0,i.jsx)(n.p,{children:"Result:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-sh",children:"App is running\n"})}),"\n",(0,i.jsx)(n.p,{children:"No API access.\r\nNo authentication.\r\nNo Service Account usage."}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Step 3: Disable Token Mount at Pod Level"})}),"\n",(0,i.jsx)(n.p,{children:"Now create the same pod, but explicitly disable token mounting."}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-yaml",children:'apiVersion: v1\r\nkind: Pod\r\nmetadata:\r\n  name: no-token-pod\r\nspec:\r\n  automountServiceAccountToken: false\r\n  containers:\r\n  - name: app\r\n    image: busybox\r\n    command: ["sh", "-c", "sleep 3600"]\r\n\n'})}),"\n",(0,i.jsx)(n.p,{children:"Apply it:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-sh",children:"kubectl apply -f pod-no-token.yaml\n"})}),"\n",(0,i.jsx)(n.p,{children:"Verify token mount:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-sh",children:"kubectl exec -it no-token-pod -- ls /var/run/secrets/kubernetes.io/serviceaccount/\n"})}),"\n",(0,i.jsx)(n.p,{children:"Expected result:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-sh",children:"ls: /var/run/secrets/kubernetes.io/serviceaccount/: No such file or directory\n"})}),"\n",(0,i.jsx)(n.p,{children:"No token\r\nPod still runs\r\nWorkload is unaffected"}),"\n",(0,i.jsx)(n.h3,{id:"key-takeaways",children:"Key Takeaways"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"Pods do not need a Service Account unless they access the Kubernetes API."}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"Kubernetes assigns one by default to enforce secure-by-default identity handling."}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"You cannot remove the Service Account object from a pod."}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"You can remove its power by disabling token mounting."}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"Disabling unused tokens is a simple and effective security hardening step."}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"Always follow the principle of least privilege\u2014even for identities you don\u2019t actively use."}),"\n"]}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(d,{...e})}):d(e)}}}]);