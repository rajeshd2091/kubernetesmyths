"use strict";(globalThis.webpackChunkmy_website=globalThis.webpackChunkmy_website||[]).push([[7764],{1150:(e,n,i)=>{i.d(n,{A:()=>s});const s=i.p+"assets/images/image_digest-7eb10cd0b14391628e6c76767526d352.jpg"},7706:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>d,contentTitle:()=>r,default:()=>h,frontMatter:()=>a,metadata:()=>s,toc:()=>c});const s=JSON.parse('{"id":"k8s-ecosystem-myths/container-image-myths/A_Container_Image_Digest_Uniquely_Identifies_One_Image","title":"Myth: A Container Image Digest Uniquely Identifies One Image","description":"When discussing container images, the term digest is often used without qualification:","source":"@site/docs/k8s-ecosystem-myths/container-image-myths/A_Container_Image_Digest_Uniquely_Identifies_One_Image.md","sourceDirName":"k8s-ecosystem-myths/container-image-myths","slug":"/k8s-ecosystem-myths/container-image-myths/A_Container_Image_Digest_Uniquely_Identifies_One_Image","permalink":"/k8s-ecosystem-myths/container-image-myths/A_Container_Image_Digest_Uniquely_Identifies_One_Image","draft":false,"unlisted":false,"editUrl":"https://github.com/kubernetes-myths/website/blob/main/docs/k8s-ecosystem-myths/container-image-myths/A_Container_Image_Digest_Uniquely_Identifies_One_Image.md","tags":[],"version":"current","sidebarPosition":3,"frontMatter":{"sidebar_position":3},"sidebar":"k8sEcosystemMythsSidebar","previous":{"title":"Myth: Container images truly support \u201cbuild once, deploy anywhere\\"","permalink":"/k8s-ecosystem-myths/container-image-myths/Container_images_truly_support_build_once_deploy_anywhere"},"next":{"title":"OCI Registry Myths","permalink":"/category/oci-registry-myths"}}');var t=i(4848),l=i(8453);const a={sidebar_position:3},r="Myth: A Container Image Digest Uniquely Identifies One Image",d={},c=[{value:"Why This Myth Exists?",id:"why-this-myth-exists",level:3},{value:"The Reality",id:"the-reality",level:3},{value:"Experiment &amp; Validate",id:"experiment--validate",level:3},{value:"Key Takeaways",id:"key-takeaways",level:3}];function o(e){const n={code:"code",em:"em",h1:"h1",h3:"h3",header:"header",img:"img",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,l.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.header,{children:(0,t.jsx)(n.h1,{id:"myth-a-container-image-digest-uniquely-identifies-one-image",children:"Myth: A Container Image Digest Uniquely Identifies One Image"})}),"\n",(0,t.jsx)(n.p,{children:"When discussing container images, the term digest is often used without qualification:"}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.em,{children:"\u201cThis image is pinned by digest, so every node will run the same image.\u201d"})}),"\n",(0,t.jsx)(n.p,{children:"The statement sounds correct and is commonly accepted during design reviews and security discussions."}),"\n",(0,t.jsx)(n.p,{children:"The subtle assumption is that a digest uniquely identifies the image, regardless of platform."}),"\n",(0,t.jsx)(n.p,{children:"What usually goes unspoken is that container images can be resolved at different levels, each with its own digest."}),"\n",(0,t.jsx)(n.h3,{id:"why-this-myth-exists",children:"Why This Myth Exists?"}),"\n",(0,t.jsx)(n.p,{children:"This myth exists because:"}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:"CLI commands typically show only one digest"}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:"People rarely inspect multi-arch images explicitly"}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:"Most examples use digests without mentioning platform resolution"}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:"Tooling hides the difference between index and image manifests"}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:"The term \u201cimage digest\u201d is used loosely across documentation"}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:"As a result, different digests are mentally collapsed into one."}),"\n",(0,t.jsx)(n.h3,{id:"the-reality",children:"The Reality"}),"\n",(0,t.jsx)(n.p,{children:"In a multi-architecture container image, there are at least two important digests involved."}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:"Manifest list (OCI image index) digest"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:"Represents all supported platforms"}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:"Acts as a top-level entry point"}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:"Used when referencing a multi-arch image generically"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:"Image manifest digest (platform-specific)"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:"Represents a single OS/architecture combination"}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:"Selected at pull time based on the node platform"}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:"Refers to the actual image that will run on the node"}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:"Both are valid digests \u2014 but they identify different things."}),"\n",(0,t.jsx)(n.p,{children:"When Kubernetes pulls an image:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:"The tag or index digest is resolved first"}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:"A platform-specific manifest is selected"}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:"The node ultimately runs the image identified by the platform-specific digest"}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:"Two nodes using the same reference may therefore run images with different digests."}),"\n",(0,t.jsx)(n.h3,{id:"experiment--validate",children:"Experiment & Validate"}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Step 1: Open Nginx official Image on Dockerhub Console"})}),"\n",(0,t.jsx)(n.p,{children:"You will see two digest for a single tag on below screen shot"}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.img,{alt:"Image Digests",src:i(1150).A+"",width:"1857",height:"831"})}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Step 2: Pull image using Index Digest"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-sh",children:"docker image pull nginx@sha256:8491795299c8e739b7fcc6285d531d9812ce2666e07bd3dd8db00020ad132295\n"})}),"\n",(0,t.jsx)(n.p,{children:"An index digest represents a list of images built for different architectures, and at pull time the container runtime resolves it to the image matching the host architecture"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-sh",children:"docker.io/library/nginx@sha256:8491795299c8e739b7fcc6285d531d9812ce2666e07bd3dd8db00020ad132295: Pulling from library/nginx\r\n1074353eec0d: Pull complete \r\n25f453064fd3: Pull complete \r\n567f84da6fbd: Pull complete \r\nda7c973d8b92: Pull complete \r\n33f95a0f3229: Pull complete \r\n085c5e5aaa8e: Pull complete \r\n0abf9e567266: Pull complete \r\nde54cb821236: Pull complete \r\nDigest: sha256:8491795299c8e739b7fcc6285d531d9812ce2666e07bd3dd8db00020ad132295\r\nStatus: Downloaded newer image for nginx@sha256:8491795299c8e739b7fcc6285d531d9812ce2666e07bd3dd8db00020ad132295\r\ndocker.io/library/nginx@sha256:8491795299c8e739b7fcc6285d531d9812ce2666e07bd3dd8db00020ad132295\n"})}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Step 3: Pull image using Manifest Digest"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-sh",children:"docker image pull nginx@sha256:cd43d3ef69d1a01d2d4b4408e8339379851f44d7d51917b59a295a13f80d54b5\n"})}),"\n",(0,t.jsx)(n.p,{children:"A manifest digest represents one architecture-specific image, so the container runtime pulls only that image, regardless of the host architecture."}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-sh",children:"docker.io/library/nginx@sha256:cd43d3ef69d1a01d2d4b4408e8339379851f44d7d51917b59a295a13f80d54b5: Pulling from library/nginx\r\nc21df6a7383d: Pull complete \r\n30f3b9423019: Pull complete \r\n5479f44a40d9: Pull complete \r\n6e9406abd83b: Pull complete \r\n502579c506c5: Pull complete \r\n700eb6e94388: Pull complete \r\n5d474d442767: Pull complete \r\nc2a512aa2aa2: Pull complete \r\nDigest: sha256:cd43d3ef69d1a01d2d4b4408e8339379851f44d7d51917b59a295a13f80d54b5\r\nStatus: Downloaded newer image for nginx@sha256:cd43d3ef69d1a01d2d4b4408e8339379851f44d7d51917b59a295a13f80d54b5\r\ndocker.io/library/nginx@sha256:cd43d3ef69d1a01d2d4b4408e8339379851f44d7d51917b59a295a13f80d54b5\n"})}),"\n",(0,t.jsx)(n.h3,{id:"key-takeaways",children:"Key Takeaways"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:"Not all digests identify the same object"}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:"A multi-arch image has an index digest and image manifest digests"}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:"The index digest represents all platforms"}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:"The image manifest digest represents one platform"}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:"Kubernetes nodes ultimately run platform-specific images"}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:"Pinning the wrong digest can lead to false assumptions about uniformity"}),"\n"]}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,l.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(o,{...e})}):o(e)}},8453:(e,n,i)=>{i.d(n,{R:()=>a,x:()=>r});var s=i(6540);const t={},l=s.createContext(t);function a(e){const n=s.useContext(l);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function r(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:a(e.components),s.createElement(l.Provider,{value:n},e.children)}}}]);