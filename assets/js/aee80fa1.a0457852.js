"use strict";(globalThis.webpackChunkmy_website=globalThis.webpackChunkmy_website||[]).push([[726],{6203:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>l,contentTitle:()=>c,default:()=>h,frontMatter:()=>o,metadata:()=>r,toc:()=>a});const r=JSON.parse('{"id":"k8s-core-myths/pod-and-container-myths/Pods_Don\u2019t_Consume_Compute_Resources_Because_They_Are_Logical","title":"Myth: Pods Don\u2019t Consume Compute Resources Because They Are Logical","description":"This belief feels correct.","source":"@site/docs/k8s-core-myths/pod-and-container-myths/Pods_Don\u2019t_Consume_Compute_Resources_Because_They_Are_Logical.md","sourceDirName":"k8s-core-myths/pod-and-container-myths","slug":"/k8s-core-myths/pod-and-container-myths/Pods_Don\u2019t_Consume_Compute_Resources_Because_They_Are_Logical","permalink":"/k8s-core-myths/pod-and-container-myths/Pods_Don\u2019t_Consume_Compute_Resources_Because_They_Are_Logical","draft":false,"unlisted":false,"editUrl":"https://github.com/kubernetes-myths/website/blob/main/docs/k8s-core-myths/pod-and-container-myths/Pods_Don\u2019t_Consume_Compute_Resources_Because_They_Are_Logical.md","tags":[],"version":"current","sidebarPosition":2,"frontMatter":{"sidebar_position":2},"sidebar":"k8sCoreMythsSidebar","previous":{"title":"Pod and Container Myths","permalink":"/category/pod-and-container-myths"},"next":{"title":"Security Myths","permalink":"/category/security-myths"}}');var i=s(4848),t=s(8453);const o={sidebar_position:2},c="Myth: Pods Don\u2019t Consume Compute Resources Because They Are Logical",l={},a=[{value:"Why This Myth Exists?",id:"why-this-myth-exists",level:3},{value:"The Reality:",id:"the-reality",level:3},{value:"Experiment &amp; Validate",id:"experiment--validate",level:3},{value:"Key Takeaways",id:"key-takeaways",level:3}];function d(e){const n={code:"code",em:"em",h1:"h1",h3:"h3",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,t.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"myth-pods-dont-consume-compute-resources-because-they-are-logical",children:"Myth: Pods Don\u2019t Consume Compute Resources Because They Are Logical"})}),"\n",(0,i.jsx)(n.p,{children:"This belief feels correct."}),"\n",(0,i.jsx)(n.p,{children:"We learn early that:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"Pods are logical"}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"Containers are the real workloads"}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"Resource requests belong to containers"}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"So it is natural to conclude:"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"\u201cIf the Pod itself doesn\u2019t run, it shouldn\u2019t consume resources.\u201d"})}),"\n",(0,i.jsx)(n.p,{children:"I believed this too."}),"\n",(0,i.jsx)(n.h3,{id:"why-this-myth-exists",children:"Why This Myth Exists?"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"Kubernetes correctly describes Pods as logical constructs"}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"There is no visible \u201cPod process\u201d on the node"}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"The pause container looks insignificant"}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"Most clusters work fine without explicit Pod Overhead"}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"All of this reinforces the idea that:"}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-sh",children:"\u201cPods are free; containers pay the cost.\u201d\n"})}),"\n",(0,i.jsx)(n.h3,{id:"the-reality",children:"The Reality:"}),"\n",(0,i.jsxs)(n.p,{children:["A Pod does not execute code, but ",(0,i.jsx)(n.strong,{children:"Kubernetes must still create an execution environment for it."})]}),"\n",(0,i.jsx)(n.p,{children:"To make a Pod runnable, Kubernetes creates:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"A sandbox (pause) container"}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"A network namespace and Pod IP"}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"CNI routing, filtering, and kernel state"}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"cgroups and namespace bookkeeping"}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"Runtime isolation structures"}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"These consume real CPU and memory, even before your application runs."}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.em,{children:"The Pod is logical."}),"\r\n",(0,i.jsx)(n.em,{children:"The environment created for it is not."})]}),"\n",(0,i.jsx)(n.p,{children:"Pod Overhead represents the fixed, per-Pod cost of this environment."}),"\n",(0,i.jsx)(n.p,{children:"It exists to account for:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"Resources consumed outside container cgroups"}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"Costs that cannot be charged to any container"}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"Overhead that exists even when containers are idle"}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"Pod Overhead is:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"Considered by the scheduler and quotas"}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:["Declared via ",(0,i.jsx)(n.code,{children:"RuntimeClass"})]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:["Not enforced by ",(0,i.jsx)(n.code,{children:"cgroups"})]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"experiment--validate",children:"Experiment & Validate"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Step 1. Create RuntimeClass with Pod Overhead"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-yaml",children:'apiVersion: node.k8s.io/v1\r\nkind: RuntimeClass\r\nmetadata:\r\n  name: kata-fc\r\nhandler: kata-fc\r\noverhead:\r\n  podFixed:\r\n    memory: "120Mi"\r\n    cpu: "250m"\n'})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Step 2. Create a Pod using runtime class"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-yaml",children:"apiVersion: v1\r\nkind: Pod\r\nmetadata:\r\n  name: test-pod\r\nspec:\r\n  runtimeClassName: kata-fc\r\n  containers:\r\n  - name: busybox-ctr\r\n    image: busybox:1.28\r\n    stdin: true\r\n    tty: true\r\n    resources:\r\n      limits:\r\n        cpu: 500m\r\n        memory: 100Mi\r\n  - name: nginx-ctr\r\n    image: nginx\r\n    resources:\r\n      limits:\r\n        cpu: 1500m\r\n        memory: 100Mi\n"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Setp 3. Verify the container requests for the workload:"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-sh",children:"kubectl get pod test-pod -o jsonpath='{.spec.containers[*].resources.limits}' \n"})}),"\n",(0,i.jsx)(n.p,{children:"The total container requests are 2000m CPU and 200MiB of memory:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-sh",children:"map[cpu: 500m memory:100Mi] map[cpu:1500m memory:100Mi]\n"})}),"\n",(0,i.jsx)(n.p,{children:"Check this against what is observed by the node:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-sh",children:"kubectl describe node | grep test-pod -B2\n"})}),"\n",(0,i.jsx)(n.p,{children:"The output shows requests for 2250m CPU, and for 320MiB of memory. The requests include Pod overhead:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-sh",children:"Namespace    Name       CPU Requests  CPU Limits   Memory Requests  Memory Limits  AGE\r\n  ---------    ----       ------------  ----------   ---------------  -------------  ---\r\n  default      test-pod   2250m (56%)   2250m (56%)  320Mi (1%)       320Mi (1%)     36m\n"})}),"\n",(0,i.jsx)(n.h3,{id:"key-takeaways",children:"Key Takeaways"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"Logical objects can still cause physical cost"}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"Pods don\u2019t consume resources \u2014 their environment does"}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"Container limits do not cap Pod infrastructure usage"}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"Pod Overhead makes hidden costs visible"}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"High Pod counts amplify this effect"}),"\n"]}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(d,{...e})}):d(e)}},8453:(e,n,s)=>{s.d(n,{R:()=>o,x:()=>c});var r=s(6540);const i={},t=r.createContext(i);function o(e){const n=r.useContext(t);return r.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:o(e.components),r.createElement(t.Provider,{value:n},e.children)}}}]);