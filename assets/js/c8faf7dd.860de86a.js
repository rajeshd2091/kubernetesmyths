"use strict";(globalThis.webpackChunkmy_website=globalThis.webpackChunkmy_website||[]).push([[2200],{6993:(e,s,t)=>{t.r(s),t.d(s,{assets:()=>i,contentTitle:()=>o,default:()=>d,frontMatter:()=>l,metadata:()=>n,toc:()=>u});const n=JSON.parse('{"id":"k8s-core-myths/storage-myths/Kubernetes_Cluster_Can_Have_Only_One_Default_StorageClass","title":"Myth: Kubernetes Cluster Can Have Only One Default StorageClass","description":"You\'re defining a new StorageClass and set:","source":"@site/docs/k8s-core-myths/storage-myths/Kubernetes_Cluster_Can_Have_Only_One_Default_StorageClass.md","sourceDirName":"k8s-core-myths/storage-myths","slug":"/k8s-core-myths/storage-myths/Kubernetes_Cluster_Can_Have_Only_One_Default_StorageClass","permalink":"/k8s-core-myths/storage-myths/Kubernetes_Cluster_Can_Have_Only_One_Default_StorageClass","draft":false,"unlisted":false,"editUrl":"https://github.com/kubernetes-myths/website/blob/main/docs/k8s-core-myths/storage-myths/Kubernetes_Cluster_Can_Have_Only_One_Default_StorageClass.md","tags":[],"version":"current","frontMatter":{},"sidebar":"k8sCoreMythsSidebar","previous":{"title":"Storage Myths","permalink":"/category/storage-myths"},"next":{"title":"Myth: Kubernetes PersistentVolumeClaim Can Be Resized","permalink":"/k8s-core-myths/storage-myths/Kubernetes_PersistentVolumeClaim_Can_Be_Resized"}}');var a=t(4848),r=t(8453);const l={},o="Myth: Kubernetes Cluster Can Have Only One Default StorageClass",i={},u=[{value:"Why This Myth Exists?",id:"why-this-myth-exists",level:3},{value:"The Reality",id:"the-reality",level:3},{value:"Experiment &amp; Validate",id:"experiment--validate",level:3},{value:"Key Takeaways",id:"key-takeaways",level:3}];function c(e){const s={code:"code",h1:"h1",h3:"h3",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,r.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(s.header,{children:(0,a.jsx)(s.h1,{id:"myth-kubernetes-cluster-can-have-only-one-default-storageclass",children:"Myth: Kubernetes Cluster Can Have Only One Default StorageClass"})}),"\n",(0,a.jsx)(s.p,{children:"You're defining a new StorageClass and set:"}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-yaml",children:'metadata:\r\n  annotations:\r\n    storageclass.kubernetes.io/is-default-class: "true"\n'})}),"\n",(0,a.jsx)(s.p,{children:'You assume Kubernetes will reject or warn if another default already exists. After all, "default" means only one, right?'}),"\n",(0,a.jsx)(s.p,{children:"So you apply multiple StorageClass resources with the same default annotation \u2014 and nothing happens. No error. No warning."}),"\n",(0,a.jsx)(s.p,{children:"You run:"}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-yaml",children:"kubectl get sc -o custom-columns=NAME:.metadata.name,DEFAULT:.metadata.annotations.storageclass\\.kubernetes\\.io/is-default-class\n"})}),"\n",(0,a.jsx)(s.p,{children:'And you see two or more default classes marked "true".'}),"\n",(0,a.jsx)(s.h3,{id:"why-this-myth-exists",children:"Why This Myth Exists?"}),"\n",(0,a.jsxs)(s.ul,{children:["\n",(0,a.jsx)(s.li,{children:"The term \u201cdefault\u201d creates the impression that only one can exist."}),"\n",(0,a.jsx)(s.li,{children:"Most tutorials and cluster setups only define one, reinforcing this assumption."}),"\n",(0,a.jsx)(s.li,{children:"The lack of enforcement is not widely documented."}),"\n",(0,a.jsx)(s.li,{children:"Engineers expect the system to prevent ambiguous behavior\u2014but Kubernetes allows it."}),"\n"]}),"\n",(0,a.jsx)(s.h3,{id:"the-reality",children:"The Reality"}),"\n",(0,a.jsxs)(s.p,{children:["You can create multiple default StorageClasses in a Kubernetes cluster.\r\nThe  ",(0,a.jsx)(s.code,{children:'"storageclass.kubernetes.io/is-default-class": "true" '})," annotation is not enforced by Kubernetes \u2014 it's simply a marker."]}),"\n",(0,a.jsxs)(s.ul,{children:["\n",(0,a.jsx)(s.li,{children:"When a PVC omits storageClassName, the system looks for a StorageClass with that annotation."}),"\n",(0,a.jsx)(s.li,{children:"If more than one exists,  Kubernetes uses the most recently created default StorageClass."}),"\n",(0,a.jsx)(s.li,{children:"Kubernetes does not raise any warning or error when multiple defaults exist."}),"\n",(0,a.jsx)(s.li,{children:"It's up to cluster admins to ensure only one default exists for consistent PVC provisioning."}),"\n"]}),"\n",(0,a.jsx)(s.h3,{id:"experiment--validate",children:"Experiment & Validate"}),"\n",(0,a.jsx)(s.p,{children:(0,a.jsx)(s.strong,{children:"Step 1: Create Two Default StorageClasses"})}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-yaml",children:'apiVersion: storage.k8s.io/v1\r\nkind: StorageClass\r\nmetadata:\r\n  name: fast-default\r\n  annotations:\r\n    storageclass.kubernetes.io/is-default-class: "true"\r\nprovisioner: kubernetes.io/no-provisioner\r\n---\r\napiVersion: storage.k8s.io/v1\r\nkind: StorageClass\r\nmetadata:\r\n  name: slow-default\r\n  annotations:\r\n    storageclass.kubernetes.io/is-default-class: "true"\r\nprovisioner: kubernetes.io/no-provisioner\n'})}),"\n",(0,a.jsx)(s.p,{children:(0,a.jsx)(s.strong,{children:"Step 2: Apply"})}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-sh",children:"kubectl apply -f dual-default-sc.yaml\n"})}),"\n",(0,a.jsx)(s.p,{children:(0,a.jsx)(s.strong,{children:"Step 3: List All Defaults"})}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-sh",children:"kubectl get sc -o custom-columns=NAME:.metadata.name,DEFAULT:.metadata.annotations.storageclass\\.kubernetes\\.io/is-default-class\n"})}),"\n",(0,a.jsxs)(s.p,{children:["You\u2019ll see both ",(0,a.jsx)(s.strong,{children:"fast-default"})," and ",(0,a.jsx)(s.strong,{children:"slow-default"})," marked as default. No error. No warning."]}),"\n",(0,a.jsx)(s.h3,{id:"key-takeaways",children:"Key Takeaways"}),"\n",(0,a.jsxs)(s.ul,{children:["\n",(0,a.jsx)(s.li,{children:"Kubernetes allows multiple default StorageClasses without any warning."}),"\n",(0,a.jsx)(s.li,{children:"The \u201cdefault\u201d is an annotation, not a rule."}),"\n",(0,a.jsx)(s.li,{children:"If more than one default exists, PVCs without storageClassName will use most recently created StorageClass."}),"\n",(0,a.jsx)(s.li,{children:"Always ensure only one default StorageClass exists to avoid confusion."}),"\n"]})]})}function d(e={}){const{wrapper:s}={...(0,r.R)(),...e.components};return s?(0,a.jsx)(s,{...e,children:(0,a.jsx)(c,{...e})}):c(e)}},8453:(e,s,t)=>{t.d(s,{R:()=>l,x:()=>o});var n=t(6540);const a={},r=n.createContext(a);function l(e){const s=n.useContext(r);return n.useMemo(function(){return"function"==typeof e?e(s):{...s,...e}},[s,e])}function o(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:l(e.components),n.createElement(r.Provider,{value:s},e.children)}}}]);